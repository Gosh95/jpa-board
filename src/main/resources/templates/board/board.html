<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{/fragments/fragmentHeader :: header (~{::title})}">
  <title th:text="#{board.title}"></title>
</head>
<body>
<nav th:replace="~{/fragments/fragmentNavigator :: nav}" />

<main class="container">
  <div th:replace="~{/fragments/fragmentTitle :: title (|#{post.main.title}|)}" ></div>
<!--  <div class="d-flex justify-content-between mb-3">-->
<!--    <div th:with="prev=${board.id - 1}" th:classappend="${prev == 0} ? 'hidden'">-->
<!--      <button class="btn btn-dark" th:onclick="|location.href='@{/boards/{boardId} (boardId = ${prev})}'|">-->
<!--        <span th:text="#{prev.board}"></span>-->
<!--      </button>-->
<!--    </div>-->
<!--    <div th:with="next=${board.id + 1}" th:classappend="${next == totalSize + 1} ? 'hidden'">-->
<!--      <button class="btn btn-dark" th:onclick="|location.href='@{/boards/{boardId} (boardId = ${next})}'|">-->
<!--        <span th:text="#{next.board}"></span>-->
<!--      </button>-->
<!--    </div>-->
<!--  </div>-->
  <div class="form-floating mb-3">
    <div class="form-control" th:text="${board.title}"></div>
  </div>

  <div class="form-floating">
    <div class="form-control content" th:text="${board.content}" style="height: 250px"></div>
  </div>

  <div class="write-btn">
    <button th:onclick="|location.href='@{/boards/{boardId}/edit (boardId =${board.id})}'|" type="button" class="btn btn-dark btn-edit">
      <span th:text="#{edit.button}">edit</span>
    </button>
    <button type="button" class="btn btn-dark btn-delete">
      <span th:text="#{delete.button}">delete</span>
    </button>
  </div>
  </br>

  <div class="my-3 p-3 bg-body rounded shadow-sm">
    <h6 class="border-bottom pb-2 mb-0">Comments</h6>
    <th:block>
    <div class="d-flex text-muted pt-3 border-bottom" th:each="comment : ${comments}">
      <svg class="bd-placeholder-img flex-shrink-0 me-2 rounded" width="32" height="32" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: 32x32" preserveAspectRatio="xMidYMid slice" focusable="false"><title>Placeholder</title><rect width="100%" height="100%" fill="#212529"/><text x="50%" y="50%" fill="#007bff" dy=".3em"></text></svg>

      <p class="pb-3 mb-0 small lh-sm">
        <strong class="d-block text-gray-dark" th:text="${'writer'}">@username</strong>
        <span th:text="${comment.content}">
          Some representative placeholder content, with some information about this user. Imagine this being some sort of status update, perhaps?
        </span>
      </p>
    </div>
    </th:block>
    <div class="d-flex justify-content-center" th:with="first=${comments.first}, last=${comments.last}">
      <button type="button" th:onclick="|location.href='@{/boards/{boardId}/comments (boardId=${board.id}, page=${comments.number - 1})}'|" class="btn btn-dark btn-lg" th:classappend="${first} ? 'disabled'"><i class="fas fa-caret-left fa-lg"></i></button>
      <button type="button" th:onclick="|location.href='@{/boards/{boardId}/comments (boardId=${board.id}, page=${comments.number + 1})}'|" class="btn btn-dark btn-lg" th:classappend="${last} ? 'disabled'"><i class="fas fa-caret-right fa-lg"></i></button>
    </div>
  </div>

  <form class="mb-3" th:object="${commentCreateDto}" th:action="@{/boards/{boardId}/new-comment (boardId=${board.id})}" method="post">
    <div class="input-group mb-1">
      <textarea id="comment" class="form-control" th:field="*{content}" th:classappend="${#fields.hasErrors('content')} ? 'is-invalid'" aria-label="With textarea" maxlength="100"></textarea>
      <button type="submit" class="btn btn-secondary comment-btn" th:text="#{enter.comment}"></button>
    </div>
    <p th:if="${#fields.hasErrors('content')}" th:errors="*{content}" th:class="error-message"></p>
  </form>
</main>

<!-- Optional JavaScript; choose one of the two! -->

<!-- Option 1: Bootstrap Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

<!-- Option 2: Separate Popper and Bootstrap JS -->
<!--
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
-->
<script th:inline="javascript">
  const deleteBtn = document.querySelector(".btn-delete");
  const commentBtn = document.querySelector(".comment-btn");
  const boardId = [[${board.id}]];

  // commentBtn.addEventListener("click", (e) => {
  //   const form = document.createElement('form');
  //   form.setAttribute('action', `/boards/${boardId}/new-comment`)
  //   form.setAttribute('method', 'post');
  //
  //   document.body.append(form);
  //
  //   form.submit();
  // });

  deleteBtn.addEventListener("click", (e) => {
    const answer = confirm("정말로 삭제하시겠습니까");

    if(answer === true) {
      const form = document.createElement('form');
      form.setAttribute('action', `/boards/${boardId}/delete`)
      form.setAttribute('method', 'post');

      document.body.append(form);

      form.submit();
    }
  });
</script>
</body>
</html>